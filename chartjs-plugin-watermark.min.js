var watermarkPlugin={defaultOptions:{x:0,y:0,height:!1,width:!1,alignX:"top",alignY:"left",position:"front",opacity:1,image:!1},isPercentage:function(a){return"string"==typeof a&&"%"==a.charAt(a.length-1)},calcPercentage:function(a,b){var c=a.substr(0,a.length-1);return c=parseFloat(c),b*(c/100)},autoPercentage:function(a,b){return this.isPercentage(a)&&(a=this.calcPercentage(a,b)),a},imageFromString:function(a){var b=new Image;return b.src=a,b},drawWatermark:function(a,b){var c=a.watermark;if(c.position==b&&c.image){var d=c.image,e=a.chart.ctx,f=e.canvas,g=f.clientHeight||f.height,h=f.clientWidth||f.width,i=c.height||d.height;i=this.autoPercentage(i,g);var j=c.width||d.width;j=this.autoPercentage(j,h);var k=this.autoPercentage(c.x,h),l=this.autoPercentage(c.y,g);switch(c.alignX){case"right":k=h-k-j;break;case"middle":k=h/2-j/2-k}switch(c.alignY){case"bottom":l=g-l-i;break;case"middle":l=g/2-i/2-l}e.save(),e.globalAlpha=c.opacity,e.drawImage(d,k,l,j,i),e.restore()}},beforeInit:function(a){a.watermark={};var b=a.options;if(b.watermark){var c=Chart.helpers.extend(this.defaultOptions,b.watermark);if(c.image){var d=c.image;"string"==typeof d&&(d=this.imageFromString(d)),d.onload=function(){a.update()},c.image=d}a.watermark=c}},beforeDraw:function(a){this.drawWatermark(a,"back")},afterDraw:function(a){this.drawWatermark(a,"front")}};Chart="function"==typeof Chart?Chart:window.Chart,Chart.pluginService.register(watermarkPlugin);